
<link href="../css/plugins/slick/slick.css" rel="stylesheet">
<link href="../css/plugins/slick/slick-theme.css" rel="stylesheet">
<style type="text/css">
    .small-pic{
        width:16%;
        height:70px;
        margin: 7px 10px 7px 0px;
        background-size: auto 100%;
        background-repeat: no-repeat;
    }
    .delImg{
        color:#fff;
        background-color:#000;
        font-size:15px;
        height:15px;
        width:15px;
        display: none;
        margin-top:-15px;
    }
    .ibox-title{
        filter:alpha(opacity=0);
        -moz-opacity:0;
        -khtml-opacity: 0;
        opacity: 0;
        height:100%;
    }
    .metrics{
        height:130px;
    }
    .progress{
        border:1px solid #5bc0de;
    }
    .progress-bar{
        background-color:#5bc0de;
    }
    .disabled {
        pointer-events: none;
    }
    .fruitUnitDiv{
        margin-top:8px;
    }
    .showImgDiv{

    }
    .imgWindow{
        width:100%;
        height:300px;
        overflow: hidden;
    }
    .imgUl{
        padding:0px;
        position: relative;
    }
    .imgUl li{
        height:300px;
        position: absolute;
        list-style-type: none;
    }
    .imgUl li div{
        width:100%;
        height:100%;
        border:1px solid #e8e9ea;
        background-size: 100% auto;
        background-repeat: no-repeat;
    }
    .imgControl{
        width:100%;
        height:100px;
        position: relative;
    }
    .imgControl i{
        color:#5bc0de;
        font-size:18px;
        line-height:80px;
        margin:0px auto;
        position: absolute;
        cursor:pointer;
    }
    .imgControl .fa-chevron-circle-left{
        left:40px;
    }
    .imgControl .fa-chevron-circle-right{
         right:40px;
    }
    .imgControlUl{
        padding: 0px;
        margin:0px auto;
        position: absolute;
    }
    .imgControlUl li{
        list-style-type: none;
        line-height:100px;
        margin:0px 5px;
        width:10px;
        cursor:pointer;
    }
</style>



<div class="row">
    <div class="col-lg-12">

        <div class="ibox product-detail">
            <div class="ibox-content">

                <div class="row">
                    <div class="col-md-5 m-t-lg">



                        <div class="showImgDiv">
                            <div class="imgWindow">
                                <ul class="imgUl">
                                    <li>1</li>
                                    <li>2</li>
                                    <li>3</li>
                                </ul>
                            </div>
                            <div class="imgControl m-t-lg">
                                <i class="fa fa-chevron-circle-left" data-page="-1"></i>
                                <ul class="imgControlUl">
                                    <li class="fa fa-circle" data-page="0"></li>
                                    <li class="fa fa-circle-o" data-page="1"></li>
                                    <li class="fa fa-circle-o" data-page="2"></li>
                                </ul>
                                <i class="fa fa-chevron-circle-right" data-page="+1"></i>
                            </div>
                        </div>


                    </div>
                    <div class="col-md-7">

                        <h2 class="font-bold m-b-xs">
                            <span class="fruitName">Desktop publishing software</span>
                        </h2>
                        <small class="fruitDesc">Many desktop publishing packages and web page editors now.</small>
                        <hr>
                        <div style="height: 60px; ">
                            <h1 class="product-main-price pull-left m-r-n-sm">
                                <i class="fa fa-rmb">&nbsp;</i>
                                <span class="fruitPrice">...</span>
                                <s class="fruitHistoryPrice"></s>
                                <small class="text-muted">元&nbsp;/&nbsp;<span class=""><b class="staticUnit">斤</b></span></small>
                            </h1>
                            <h1 class="col-sm-3 pull-left m-l-n-xl">
                                <div class="input-group fruitUnitDiv pace-inactive">
                                    <input type="text" class="fruitUnit form-control fa-align-right pull-right" style="width: 60%;" value="个"/>
                                    <div class="input-group-btn">
                                        <button data-toggle="dropdown" class="btn btn-white dropdown-toggle" type="button" aria-expanded="false"><span class="caret"></span></button>
                                        <ul class="dropdown-menu" style="min-width: 30px;">
                                            <li><a href="#">斤</a></li>
                                            <li><a href="#">个</a></li>
                                            <li><a href="#">只</a></li>
                                            <li><a href="#">坨</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </h1>
                            <div class="clearfix"></div>
                        </div>
                        <hr>
                        <div>
                            <div class="row">
                                <div class="col-md-9">
                                    <div class="row">
                                        <div class="col-md-12 small-pic-group disabled">
                                            <div class="small-pic pull-left t-border" style="opacity: 1; z-index: 0; background-image: url('../img/p6.jpg')">
                                                <div class="ibox-title"></div>
                                                <i class="delImg fa fa-times"></i>
                                            </div>

                                            <div class="small-pic pull-left t-border" style="opacity: 1; z-index: 0;">
                                                <div class="ibox-title"></div>
                                            </div>

                                            <div class="small-pic pull-left t-border" style="opacity: 1; z-index: 0;">
                                                <div class="ibox-title"></div>
                                            </div>

                                            <div class="small-pic pull-left t-border" style="opacity: 1; z-index: 0;">
                                                <div class="ibox-title"></div>
                                            </div>

                                            <div class="small-pic pull-left t-border" style="opacity: 1; z-index: 0;">
                                                <div class="ibox-title"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 btn-group">
                                    <button class="btn btn-white btn-sm" data-name="editPic" onclick="editSmallPic($(this))"><i class="fa fa-edit"></i>&nbsp;<span class="editLabel">Edit</span></button>
                                    <button class="btn btn-info btn-sm" data-toggle="modal" data-target="#myModal" onclick="uploadPic()"><i class="fa fa-star"></i> Add </button>
                                </div>
                            </div>
                        </div>
                        <hr>



                        <div class="row">
                            <div class="well col-lg-5 m-l-md metrics">
                                <h5>剩余</h5>
                                <h2><span class="remaining">3210</span>&nbsp;<span class="staticUnit2">斤</span><i class="fa fa-edit pull-right"></i></h2>

                                <div class="progress progress-small">
                                    <div class="progress-bar" style="width: 100%;"></div>
                                </div>

                                <div class="m-t-n-sm small lastInStoreInfo">上次添加时间 1.16 4:32 pm. 总量 4000</div>
                            </div>
                            <div class="well col-lg-5 m-l-md metrics">
                                <h5>月销图</h5>
                                <div id="sparkline"><canvas width="211" height="60" style="display: inline-block; width: 211px; height: 60px; vertical-align: top;"></canvas></div>
                            </div>
                        </div>

                        <hr>
                        <div class="text-right">
                            <div class="btn-group">
                                <button class="btn btn-white btn-sm"><i class="fa fa-star"></i> Add to wishlist </button>
                                <button class="btn btn-white btn-sm"><i class="fa fa-times"></i> 设置为禁售 </button>
                            </div>
                        </div>


                    </div>
                </div>

            </div>
            <div class="ibox-footer">
                                <span class="pull-right">
                                    Full stock - <i class="fa fa-clock-o"></i> 14.04.2016 10:04 pm
                                </span>
                The generated Lorem Ipsum is therefore always free
            </div>
        </div>

    </div>

</div>



<div class="ibox-content" id="ibox-content">
    <div id="vertical-timeline" class="vertical-container dark-timeline">
        <div class="vertical-timeline-block">
            <div class="vertical-timeline-icon navy-bg">
                <i class="fa fa-apple"></i>
            </div>

            <div class="vertical-timeline-content">
                <h2>Meeting</h2>
                <p>Conference on the sales results for the previous year. Monica please examine sales trends in marketing and products. Below please find the current status of the sale.
                </p>
                <a href="#" class="btn btn-sm btn-primary"> More info</a>
                <span class="vertical-date">Today<br><small>Dec 24</small></span>
            </div>
        </div>

        <div class="vertical-timeline-block">
            <div class="vertical-timeline-icon blue-bg">
                <i class="fa fa-file-text"></i>
            </div>

            <div class="vertical-timeline-content">
                <h2>Send documents to Mike</h2>
                <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since.</p>
                <a href="#" class="btn btn-sm btn-success"> Download document </a>
                <span class="vertical-date">
                                        Today <br>
                                        <small>Dec 24</small>
                                    </span>
            </div>
        </div>
        <div class="vertical-timeline-block">
            <div class="vertical-timeline-icon lazur-bg">
                <i class="fa fa-coffee"></i>
            </div>

            <div class="vertical-timeline-content">
                <h2>Coffee Break</h2>
                <p>Go to shop and find some products. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's. </p>
                <a href="#" class="btn btn-sm btn-info">Read more</a>
                <span class="vertical-date"> Yesterday <br><small>Dec 23</small></span>
            </div>
        </div>

        <div class="vertical-timeline-block">
            <div class="vertical-timeline-icon yellow-bg">
                <i class="fa fa-phone"></i>
            </div>

            <div class="vertical-timeline-content">
                <h2>Phone with Jeronimo</h2>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iusto, optio, dolorum provident rerum aut hic quasi placeat iure tempora laudantium ipsa ad debitis unde? Iste voluptatibus minus veritatis qui ut.</p>
                <span class="vertical-date">Yesterday <br><small>Dec 23</small></span>
            </div>
        </div>

        <div class="vertical-timeline-block">
            <div class="vertical-timeline-icon lazur-bg">
                <i class="fa fa-user-md"></i>
            </div>

            <div class="vertical-timeline-content">
                <h2>Go to the doctor dr Smith</h2>
                <p>Find some issue and go to doctor. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s. </p>
                <span class="vertical-date">Yesterday <br><small>Dec 23</small></span>
            </div>
        </div>

        <div class="vertical-timeline-block">
            <div class="vertical-timeline-icon navy-bg">
                <i class="fa fa-comments"></i>
            </div>

            <div class="vertical-timeline-content">
                <h2>Chat with Monica and Sandra</h2>
                <p>Web sites still in their infancy. Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like). </p>
                <span class="vertical-date">Yesterday <br><small>Dec 23</small></span>
            </div>
        </div>
    </div>

</div>

<!-- Custom and plugin javascript -->
<script src="../js/inspinia.js"></script>
<script src="../js/plugins/pace/pace.min.js"></script>

<!-- slick carousel-->
<script src="../js/plugins/slick/slick.min.js"></script>



<!-- Sparkline -->
<script src="../js/plugins/sparkline/jquery.sparkline.min.js"></script>
<script src="../js/plugins/jquery-ui/jquery-ui.min.js"></script>


<script>

    var imgWidth = $(".imgWindow").width();
    var pageIndex = 0;
    var imgCount = 2;
    var fillData;
    function fillFruitDetail(data) {
        fillData = data;
        if(data.info == "SUC"){

//            alert(data.item);
            var json = JSON.parse(data.item);
            var imgList = eval(json.IMG_LIST);

            $(".fruitName").text(json.NAME);
            $(".fruitDesc").text(json.NOTE);
            $(".fruitPrice").text(json.PRICE);
            $(".fruitHistoryPrice").text(json.HISTORY_PRICE == 0 ? "" : "("+json.HISTORY_PRICE+")");
            $(".staticUnit, .staticUnit2").text(json.UNIT_NAME);
            $(".remaining").text(json.STORE);
            $(".lastInStoreInfo").text("上次添加时间 " + publicUtil.dateFormat('2', json.LAST_IN_STORE_TIME) + ". 总量 " + json.HISTORY_STORE);



            var imgHtmlStr = "";
            for(var i = 0; i < imgList.length; i ++){
                imgHtmlStr += '<li style="left:'+(imgWidth * i)+'px;"><div style="background-image: url('+imgList[i]+');"></div></li>';
            }
            $(".imgUl").html(imgHtmlStr);
            $(".imgUl li").css("width",imgWidth+"px");



            var imgControlUlWidth = $(".imgControlUl").width();
            $(".imgControlUl").css("left",(imgWidth - imgControlUlWidth) / 2 +"px");


            setTimeout(function () {
                $(".progress .progress-bar").attr("style","width:" + (json.STORE / json.HISTORY_STORE * 100) + "%");
            },500);


        }
    }
    $(document).ready(function(){
        var fruitId = sessionStorage.currentFruitId;

        var param = {
            "param":JSON.stringify({"fruitId":fruitId})
        }
        ajaxLoad(localIp+"FruitManager/getFruitDetail.do",param,"post","JSON",fillFruitDetail,null,null);







        $('.fruitUnit').parent().children(".input-group-btn").children("ul").children("li").click(function(){
            $('.fruitUnit').val($(this).children().text());
        });






//        $(".editBtn").click(function(){
//            alert($(this).attr("data-name"));
//        });


        $(".imgControl .fa").click(function () {
            var page = $(this).attr("data-page");
            if(page == "-1"){
                if(pageIndex == 0){
                    pageIndex = imgCount;
                }else{
                    pageIndex--;
                }
            }else if(page == "+1"){
                if(pageIndex == imgCount){
                    pageIndex = 0;
                }else{
                    pageIndex++;
                }
            }else{
                pageIndex = page;
            }
            refreshImgShow();
        });
        function refreshImgShow() {
            $(".imgControlUl li:not("+pageIndex+")").removeClass("fa-circle");
            $(".imgControlUl li:not("+pageIndex+")").addClass("fa-circle-o");
            $(".imgControlUl li:eq("+pageIndex+")").removeClass("fa-circle-o");
            $(".imgControlUl li:eq("+pageIndex+")").addClass("fa-circle");
            $(".imgUl").animate({left:(imgWidth * pageIndex * -1)+"px"},200);
        }



        $('.product-images').slick({
            dots: true
        });


        var sparklineCharts = function(){
            <!-- Enable portlets -->
            WinMove();


            $("#sparkline").sparkline([3, 4, 2, 3, 5, 8, 7, 9], {
                type: 'line',
                width: '100%',
                height: '60',
                lineColor: '#d9534f',
                fillColor: "#ffffff"
            });
        };

        var sparkResize;

        $(window).resize(function(e) {
            clearTimeout(sparkResize);
            sparkResize = setTimeout(sparklineCharts, 500);
        });

        sparklineCharts();



    });

    var smallPicMoveFlag = false;
    function editSmallPic(btnObj) {
        smallPicMoveFlag = !smallPicMoveFlag;
        if(smallPicMoveFlag){
            $(".small-pic-group").removeClass("disabled");
            $('.small-pic').addClass('animated');
            $('.small-pic').addClass('tada2');
            $(".delImg").attr("style","display:block");
            $(".editLabel").text("Save");
            btnObj.removeClass("btn-white").addClass("btn-success");

            $(".fruitName").html("<input style='width:400px;' type='text' value='"+ $(".fruitName").text() +"' />");
            $(".fruitDesc").html("<input style='width:600px;' type='text' value='"+ $(".fruitDesc").text() +"' />");
            $(".fruitPrice").html("<input style='width:100px;' type='text' value='"+ $(".fruitPrice").text() +"' />");
            $(".staticUnit").addClass("pace-inactive");
            $(".fruitUnitDiv").removeClass("pace-inactive");
            $(".fruitUnit").val($(".staticUnit").text());
        }else{
            fillFruitDetail(fillData);
            $(".small-pic-group").addClass("disabled");
            $('.small-pic').removeClass('animated').removeClass('tada2');
            $(".delImg").attr("style","display:none");
            $(".editLabel").text("Edit");
            btnObj.removeClass("btn-success").addClass("btn-white");

            $(".fruitName").html($(".fruitName").children().val());
            $(".fruitDesc").html($(".fruitDesc").children().val());
            $(".fruitPrice").html($(".fruitPrice").children().val());
            $(".staticUnit").removeClass("pace-inactive");
            $(".fruitUnitDiv").addClass("pace-inactive");
            $(".staticUnit").text($(".fruitUnit").val());
            $(".staticUnit2").text($(".fruitUnit").val());
        }
        $(".delImg").click(function () {
            var smallPicDiv = $(this).parent();
            swal({
                type:'info',
                title: "",
                text: "是否移除此图片？",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "确定",
                cancelButtonText: "取消",
                closeOnConfirm: true,
            }, function (isOk) {
                if(isOk){
                    smallPicDiv.remove();
                }
            });
        });
    }

    function uploadPic() {
        ajaxLoad("store_uploadPic_modal.html","","post","text",fillModal,null,null);
        function fillModal(data){
            $("#myModal").html(data);
        }
    }

</script>